<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>moira.application documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name"></span> <span class="project-version"></span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="moira.application.html"><div class="inner"><span>moira.application</span></div></a></li><li class="depth-1 "><a href="moira.context.html"><div class="inner"><span>moira.context</span></div></a></li><li class="depth-1 "><a href="moira.event.html"><div class="inner"><span>moira.event</span></div></a></li><li class="depth-1 "><a href="moira.log.event-emitter.html"><div class="inner"><span>moira.log.event-emitter</span></div></a></li><li class="depth-1 "><a href="moira.log.module.html"><div class="inner"><span>moira.log.module</span></div></a></li><li class="depth-1 "><a href="moira.log.txs.html"><div class="inner"><span>moira.log.txs</span></div></a></li><li class="depth-1 "><a href="moira.module.html"><div class="inner"><span>moira.module</span></div></a></li><li class="depth-1 "><a href="moira.transition.html"><div class="inner"><span>moira.transition</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="moira.application.html#var-*timeout*"><div class="inner"><span>*timeout*</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-*warnings.3F*"><div class="inner"><span>*warnings?*</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-Application"><div class="inner"><span>Application</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-Chainable"><div class="inner"><span>Chainable</span></div></a></li><li class="depth-2"><a href="moira.application.html#var-then.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>then!</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-create"><div class="inner"><span>create</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-Extendable"><div class="inner"><span>Extendable</span></div></a></li><li class="depth-2 branch"><a href="moira.application.html#var-override.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>override!</span></div></a></li><li class="depth-2"><a href="moira.application.html#var-extend.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extend!</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-init.21"><div class="inner"><span>init!</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-load.21"><div class="inner"><span>load!</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-pause.21"><div class="inner"><span>pause!</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-resume.21"><div class="inner"><span>resume!</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-start.21"><div class="inner"><span>start!</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-stop.21"><div class="inner"><span>stop!</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-Thenable"><div class="inner"><span>Thenable</span></div></a></li><li class="depth-2"><a href="moira.application.html#var-then"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>then</span></div></a></li><li class="depth-1"><a href="moira.application.html#var-Transitionable"><div class="inner"><span>Transitionable</span></div></a></li><li class="depth-2 branch"><a href="moira.application.html#var-up.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>up!</span></div></a></li><li class="depth-2 branch"><a href="moira.application.html#var-tx.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tx!</span></div></a></li><li class="depth-2"><a href="moira.application.html#var-down.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>down!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">moira.application</h1><div class="doc"><pre class="plaintext">Instrument modules and their dependencies by wrapping `system-map` with an
instance of `Application`. When system lifecycle events such as `start!`,
`stop!`, `pause!`, or `resume!` are triggered, the corresponding state
`transition` executes on each module and its dependencies in order.

All modules can leverage the unified log for inter-module communication via
Application Events. The `:app-log` module is automatically injected into the
system, with all other modules implicitly depending on it for access to the
Application Log API.</pre></div><div class="public anchor" id="var-*timeout*"><h3>*timeout*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-*warnings.3F*"><h3>*warnings?*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-Application"><h3>Application</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-Chainable"><h3>Chainable</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-then.21"><h3>then!</h3><div class="usage"><code>(then! this f)</code></div><div class="doc"><pre class="plaintext">Enqueue function 'f' to update 'this' after all currently scheduled
transitions finish.

Replaces internal application state with the return value (or resolved
value if a `Promise`) of applying `f` on the settled `system-map`.

Returns a `Promise` that resolves to the updated `system-map`.</pre></div></div></div></div></div><div class="public anchor" id="var-create"><h3>create</h3><div class="usage"><code>(create system-map)</code></div><div class="doc"><pre class="plaintext">Create an Application instance from module definitions in `system-map`.

Each entry in `system-map` defines a single module by mapping keywords to
the respective module-maps incorporating all configuration and state.</pre></div></div><div class="public anchor" id="var-Extendable"><h3>Extendable</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Enhance the functionality of `Application` by adding new modules or
modifying existing ones.</pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-override.21"><h3>override!</h3><div class="usage"><code>(override! this modules)</code></div><div class="doc"><pre class="plaintext">Update `this` to include `modules` defined as a map of module keys to
(potentially partial) module definitions. New values will be added, and
existing values will be overridden.

The update will be applied once all currently ongoing transitions have
finished. New values will be added, and existing values will be overridden.

Returns a `Promise` that resolves to the updated `system-map`.</pre></div></div><div class="public anchor" id="var-extend.21"><h3>extend!</h3><div class="usage"><code>(extend! this modules)</code></div><div class="doc"><pre class="plaintext">Extend `this` to include `modules` defined as a map of module keys to
(potentially partial) module definitions. New values will be added, but
existing values are not changed.

The update will be applied once all currently ongoing transitions have
finished.

Returns a `Promise` that resolves to the updated `system-map`.</pre></div></div></div></div></div><div class="public anchor" id="var-init.21"><h3>init!</h3><div class="usage"><code>(init! app config)</code><code>(init! app config ks)</code></div><div class="doc"><pre class="plaintext">Load `config` into `app`. Returns a promise resolving to
the new system map after start.</pre></div></div><div class="public anchor" id="var-load.21"><h3>load!</h3><div class="usage"><code>(load! app modules)</code></div><div class="doc"><pre class="plaintext">Load modules defined in `modules` into `app`. Returns a promise resolving to
the new system map after start.

Updates `app` and starts all provided modules immediately. Existing modules
are extended and only started when not already up.</pre></div></div><div class="public anchor" id="var-pause.21"><h3>pause!</h3><div class="usage"><code>(pause! app)</code><code>(pause! app ks)</code></div><div class="doc"><pre class="plaintext">Halt application by applying `:pause`.

This is an alternate version of `stop` presumably called during development,
e.g. before hot reloading code.</pre></div></div><div class="public anchor" id="var-resume.21"><h3>resume!</h3><div class="usage"><code>(resume! app)</code><code>(resume! app ks)</code></div><div class="doc"><pre class="plaintext">Reactivate application by applying `:resume`.

This is an alternate version of `start` presumably called during development,
e.g. after hot reloading code.</pre></div></div><div class="public anchor" id="var-start.21"><h3>start!</h3><div class="usage"><code>(start! app)</code><code>(start! app ks)</code></div><div class="doc"><pre class="plaintext">Start modules defined in `ks` and all their dependencies. Start all modules
defined by `app`, when no `ks` are given. Returns a promise resolving to the
new system map with updated module states.

Dependencies are guaranteed to be started first. `:app-log` is injected, if
not already present, and automatically added to each module's `:deps`.

Starting a module is idempotent (i.e., `:start` is only called, when the
module is not already tagged as `:started`). Module `:state` is updated by
calling `:start` on the current value and a map of dependency keys to values
returned by applying respective `:export` on dependency `:state`.
For additional context, the module key and the `app` instance are also passed
to the update function.

When a circular dependency is detected, an error is thrown and starting is
aborted before any calls to `:start`.</pre></div></div><div class="public anchor" id="var-stop.21"><h3>stop!</h3><div class="usage"><code>(stop! app)</code><code>(stop! app ks)</code></div><div class="doc"><pre class="plaintext">Stop modules defined in `ks` and all their dependents. Stop all modules
defined by `app` when no `ks` are given. Returns a promise resolving to the
new system map with updated module states.

Dependent modules are guaranteed to be stopped first. `:stop` is only called,
when the module is tagged as `:started`. Nothing is called when a circular
dependency is detected.

Module `:state` is updated by calling `:stop` on the current value. `:stop`
defaults to setting the state to `nil`.</pre></div></div><div class="public anchor" id="var-Thenable"><h3>Thenable</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-then"><h3>then</h3><div class="usage"><code>(then this f)</code></div><div class="doc"><pre class="plaintext">`f` is called asynchronously with a settled `system-map` after all
scheduled transitions finish.

Returns a `Promise` that resolves to the updated `system-map`.</pre></div></div></div></div></div><div class="public anchor" id="var-Transitionable"><h3>Transitionable</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Manage the lifecycle of an `Application` through chained updates. The
`transition` is guaranteed to be applied on module dependencies first for
`up!` and last for `down!`.</pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-up.21"><h3>up!</h3><div class="usage"><code>(up! this txs ks)</code></div><div class="doc"><pre class="plaintext">Update `this` by elevating modules defined for `ks` and all their
dependencies in order.

The interceptor chain `txs` is applied in context of each module
respectively. When a circular dependency is detected, no updates are
applied, and an error is thrown.

Returns a `Promise` that resolves to the updated `system-map`.</pre></div></div><div class="public anchor" id="var-tx.21"><h3>tx!</h3><div class="usage"><code>(tx! this txs ks)</code></div><div class="doc"><pre class="plaintext">Update `this` by updating modules defined for `ks` without handling
dependencies.

The interceptor chain `txs` is applied in context of each module
respectively. When a circular dependency is detected, no updates are
applied, and an error is thrown.

Returns a `Promise` that resolves to the updated `system-map`.</pre></div></div><div class="public anchor" id="var-down.21"><h3>down!</h3><div class="usage"><code>(down! this txs ks)</code></div><div class="doc"><pre class="plaintext">Update `this` by tearing down modules defined for `ks` and all their
dependencies in reverse order.

The interceptor chain `txs` is applied in context of each module
respectively. When a circular dependency is detected, no updates are
applied, and an error is thrown.

Returns a `Promise` that resolves to the updated `system-map`.</pre></div></div></div></div></div></div></body></html>